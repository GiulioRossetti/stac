<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tests_no_parametricos &mdash; Plataforma Web STAC v0.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'v0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="Plataforma Web STAC v0.5 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">Plataforma Web STAC v0.5 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for tests_no_parametricos</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Thu Jan 23 14:33:54 2014</span>

<span class="sd">@author: Adrián</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="kn">as</span> <span class="nn">st</span>

<span class="c">#Para cuando el tamaño muestral N sea menor o igual a 25, se puede hacer el test de Wilcoxon</span>
<span class="c">#examinando la tabla que nos da los valores críticos (el intervalo) para cada valor de N y</span>
<span class="c">#nivel de significancia (0.10,0.05,0.02,0.01,0.005,0.001) dado. Si tenemos en cuenta que T</span>
<span class="c">#será el valor mínimo de (suma rangos positivos, suma rangos negativos), se utilizan los límites</span>
<span class="c">#inferiores de los intervalos y el contraste será estadísticamente significativo si: T &lt;= límite</span>
<span class="c">#inferior correspondiente.</span>
<span class="n">tabla_wilcoxon</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.10</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">13</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="mi">14</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">15</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span><span class="mi">17</span><span class="p">:</span><span class="mi">41</span><span class="p">,</span>
                    <span class="mi">18</span><span class="p">:</span><span class="mi">47</span><span class="p">,</span><span class="mi">19</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span><span class="mi">21</span><span class="p">:</span><span class="mi">67</span><span class="p">,</span><span class="mi">22</span><span class="p">:</span><span class="mi">75</span><span class="p">,</span><span class="mi">23</span><span class="p">:</span><span class="mi">83</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">91</span><span class="p">,</span><span class="mi">25</span><span class="p">:</span><span class="mi">100</span><span class="p">},</span>
                  <span class="mf">0.05</span><span class="p">:{</span><span class="mi">6</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">11</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">13</span><span class="p">,</span><span class="mi">13</span><span class="p">:</span><span class="mi">17</span><span class="p">,</span><span class="mi">14</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="mi">15</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">29</span><span class="p">,</span><span class="mi">17</span><span class="p">:</span><span class="mi">34</span><span class="p">,</span><span class="mi">18</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span>
                    <span class="mi">19</span><span class="p">:</span><span class="mi">46</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">52</span><span class="p">,</span><span class="mi">21</span><span class="p">:</span><span class="mi">58</span><span class="p">,</span><span class="mi">22</span><span class="p">:</span><span class="mi">65</span><span class="p">,</span><span class="mi">23</span><span class="p">:</span><span class="mi">73</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">81</span><span class="p">,</span><span class="mi">25</span><span class="p">:</span><span class="mi">89</span><span class="p">},</span>
                  <span class="mf">0.02</span><span class="p">:{</span><span class="mi">7</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">13</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">:</span><span class="mi">19</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span><span class="mi">17</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span><span class="mi">18</span><span class="p">:</span><span class="mi">32</span><span class="p">,</span><span class="mi">19</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span>
                    <span class="mi">20</span><span class="p">:</span><span class="mi">43</span><span class="p">,</span><span class="mi">21</span><span class="p">:</span><span class="mi">49</span><span class="p">,</span><span class="mi">22</span><span class="p">:</span><span class="mi">55</span><span class="p">,</span><span class="mi">23</span><span class="p">:</span><span class="mi">62</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">69</span><span class="p">,</span><span class="mi">25</span><span class="p">:</span><span class="mi">76</span><span class="p">},</span>
                  <span class="mf">0.01</span><span class="p">:{</span><span class="mi">8</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">14</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">15</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">19</span><span class="p">,</span><span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span><span class="mi">18</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span><span class="mi">19</span><span class="p">:</span><span class="mi">32</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span>
                    <span class="mi">21</span><span class="p">:</span><span class="mi">42</span><span class="p">,</span><span class="mi">22</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="mi">23</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">61</span><span class="p">,</span><span class="mi">25</span><span class="p">:</span><span class="mi">68</span><span class="p">},</span>
                  <span class="mf">0.005</span><span class="p">:{</span><span class="mi">9</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span><span class="mi">15</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span><span class="mi">17</span><span class="p">:</span><span class="mi">19</span><span class="p">,</span><span class="mi">18</span><span class="p">:</span><span class="mi">23</span><span class="p">,</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">32</span><span class="p">,</span>
                    <span class="mi">21</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="mi">22</span><span class="p">:</span><span class="mi">42</span><span class="p">,</span><span class="mi">23</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">54</span><span class="p">,</span><span class="mi">25</span><span class="p">:</span><span class="mi">60</span><span class="p">},</span>
                  <span class="mf">0.001</span><span class="p">:{</span><span class="mi">11</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">14</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">15</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="mi">16</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">17</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span><span class="mi">18</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="mi">19</span><span class="p">:</span><span class="mi">18</span><span class="p">,</span><span class="mi">20</span><span class="p">:</span><span class="mi">21</span><span class="p">,</span><span class="mi">21</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span><span class="mi">22</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span>
                    <span class="mi">23</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span><span class="mi">24</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">25</span><span class="p">:</span><span class="mi">45</span><span class="p">}}</span>

<div class="viewcode-block" id="wilcoxon_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.wilcoxon_test">[docs]</a><span class="k">def</span> <span class="nf">wilcoxon_test</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test de los Rangos Signados de Wilcoxon.</span>

<span class="sd">    .. note:: Contrasta la hipótesis nula de que las medianas de las diferencias de dos muestras (resultados de dos algoritmos)</span>
<span class="sd">              relacionadas son iguales. Para tamaños muestrales pequeños, se puede determinar mediante la comparación del</span>
<span class="sd">              estadístico con el valor crítico de la tabla de Wilcoxon. Para tamaños muestrales grandes (&gt; 25), el test se puede</span>
<span class="sd">              aproximar con la distribución normal. Se deben tener al menos 5 conjuntos de datos cuyas diferencias sean distintas</span>
<span class="sd">              de 0.</span>

<span class="sd">    Args:</span>
<span class="sd">        matriz_datos: lista de listas de float [N_conjuntos_datos * K_algoritmos]</span>
<span class="sd">            Lista que contiene una serie de listas que a su vez contienen los resultados en floats obtenidos por los distintos</span>
<span class="sd">            algoritmos.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) que se quiere utilizar para contrastar la hipótesis nula del</span>
<span class="sd">            test.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos (tamaño muestral &lt;= 25)::</span>

<span class="sd">            resultado: boolean</span>
<span class="sd">                Resultado del test de contraste de hipótesis. True indica que se rechaza la hipótesis nula. False indica que no</span>
<span class="sd">                se rechaza.</span>
<span class="sd">            estadistico: float</span>
<span class="sd">                Estadístico T calculado durante el test, donde T = min(T_Mas,T_Men) y donde T_Mas = suma rangos positivos y</span>
<span class="sd">                T_Men = suma rangos negativos.</span>
<span class="sd">            suma rangos pos: float</span>
<span class="sd">                Suma de los rangos de las diferencias mayores que 0.</span>
<span class="sd">            suma rangos neg: float</span>
<span class="sd">                Suma de los rangos de las diferencias menores que 0.</span>
<span class="sd">            punto critico: float</span>
<span class="sd">                Límite inferior del intervalo de aceptación. El contraste será estadísticamente significativo si: T &lt;= límite</span>
<span class="sd">                inferior correspondiente.</span>

<span class="sd">        dict: diccionario que contiene los siguientes elementos (tamaño muestral &gt; 25)::</span>

<span class="sd">            resultado: boolean</span>
<span class="sd">                Resultado del test de contraste de hipótesis. True indica que se rechaza la hipótesis nula. False indica que no</span>
<span class="sd">                se rechaza.</span>
<span class="sd">            p_valor: float</span>
<span class="sd">                p-valor calculado para comparar (contrastar H0) con el nivel de significancia.</span>
<span class="sd">            estadistico: float</span>
<span class="sd">                Estadístico Z calculado durante el test. Sigue una distribución normal.</span>
<span class="sd">            suma rangos pos: float</span>
<span class="sd">                Suma de los rangos de las diferencias mayores que 0.</span>
<span class="sd">            suma rangos neg: float</span>
<span class="sd">                Suma de los rangos de las diferencias menores que 0.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Manuel Oviedo - Beatriz Pateiro. *Test de los Rangos Signados de Wilcoxon para muestras apareadas.*</span>
<span class="sd">        2. Universidad de Salamanca (Jul. 2013). *Estadística para investigadores. Test no paramétricos: Test de Wilcoxon. Modulo</span>
<span class="sd">           6* [Vídeo]. URL https://www.youtube.com/watch?v=B_7Wt49dTos</span>
<span class="sd">        3. Wikipedia. *Prueba de los rangos con signo de Wilcoxon* [Documento WWW]. URL http://es.wikipedia.org/wiki/Prueba_de_los_rangos_con_signo_de_Wilcoxon</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#El test de Wilcoxon compara dos algoritmos.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Test de Wilcoxon solo aplicable a dos algoritmos&quot;</span><span class="p">)</span>

    <span class="c">#Paso de una matriz de conjuntos de datos a dos listas: lista &quot;a&quot;, que contiene</span>
    <span class="c">#los resultados de aplicar el primer algoritmo a los datos y una lista &quot;b&quot; que</span>
    <span class="c">#contiene los resultados de aplicar el segundo algoritmo sobre los mismos datos.</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">lista_datos</span> <span class="ow">in</span> <span class="n">matriz_datos</span><span class="p">:</span>
        <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lista_datos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lista_datos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="c">#Cálculo del número de veces que se aplican los dos algoritmos, es decir,</span>
    <span class="c">#el número de individuos o datos sobre los que se aplican los algoritmos. El</span>
    <span class="c">#tamaño de a y b deben ser iguales. Se conoce como tamaño muestral. Hay</span>
    <span class="c">#dos muestras: a y b.</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="c">#Cálculo de las diferencias sin signos y con signos. Se excluye el 0.</span>
    <span class="n">diferencias</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">signos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">diferencia</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">diferencia</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">diferencias</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">diferencia</span><span class="p">))</span>
            <span class="n">signos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diferencia</span><span class="p">)</span>

    <span class="c">#Tamaño muestral después de eliminar las diferencias 0.</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">diferencias</span><span class="p">)</span>

    <span class="c">#El tamaño de la muestra  (sin ligaduras) debe ser al menos de 5.</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Menos de 5 conjuntos de datos sin ligaduras&quot;</span><span class="p">)</span>

    <span class="c">#Rangos de orden 1,2,...,N. Cada elemento de copia tiene un rango asociado:</span>
    <span class="c">#indice(elemento) + 1. Si hay empates se calcula la media del rango de cada</span>
    <span class="c">#uno de los elementos repetidos.</span>
    <span class="n">copia</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">diferencias</span><span class="p">)</span>
    <span class="n">copia</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">rangos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">diferencias</span><span class="p">:</span>
        <span class="n">rangos</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">copia</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">copia</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="c">#Sumas de los rangos de las Di mayores que 0 y menores que 0.</span>
    <span class="n">mayor0</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">menor0</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">signos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mayor0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rangos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">menor0</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rangos</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">T_Mas</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mayor0</span><span class="p">)</span>
    <span class="n">T_Men</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">menor0</span><span class="p">)</span>

    <span class="c">#T es el valor mínimo de T_Mas y T_Men.</span>
    <span class="n">T</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">T_Mas</span><span class="p">,</span><span class="n">T_Men</span><span class="p">)</span>

    <span class="c">#Para tamaños muestrales pequeños, se puede determinar el test de Wilcoxon mediante la comparación</span>
    <span class="c">#de T con el valor crítico de la tabla de Wilcoxon. Para tamaños muestrales grandes, el test se puede</span>
    <span class="c">#aproximar con la distribución normal.</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">&lt;=</span> <span class="mi">25</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">alpha</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tabla_wilcoxon</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Valor de alpha no contenido en la tabla de Wilcoxon&quot;</span><span class="p">)</span>
        <span class="c">#Límite inferior del intervalo de aceptación.</span>
        <span class="n">punto_critico</span> <span class="o">=</span> <span class="n">tabla_wilcoxon</span><span class="p">[</span><span class="n">alpha</span><span class="p">][</span><span class="n">N</span><span class="p">]</span>

        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">T</span> <span class="o">&lt;=</span> <span class="n">punto_critico</span><span class="p">),</span> <span class="s">&quot;estadistico&quot;</span> <span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="s">&quot;suma rangos pos&quot;</span> <span class="p">:</span> <span class="n">T_Mas</span><span class="p">,</span>
        <span class="s">&quot;suma rangos neg&quot;</span> <span class="p">:</span> <span class="n">T_Men</span><span class="p">,</span> <span class="s">&quot;punto critico&quot;</span> <span class="p">:</span> <span class="n">punto_critico</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c">#Cálculo del valor Z</span>
        <span class="n">Z</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="o">-</span><span class="p">((</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">24</span><span class="p">)))</span>

        <span class="c">#Cálculo del p_valor: Probabilidad de obtener un valor al menos tan extremo</span>
        <span class="c">#como el estadístico Z.</span>
        <span class="n">p_valor</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Z</span><span class="p">)))</span>

        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">p_valor</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">),</span> <span class="s">&quot;p_valor&quot;</span> <span class="p">:</span> <span class="n">p_valor</span><span class="p">,</span> <span class="s">&quot;estadistico&quot;</span> <span class="p">:</span> <span class="n">Z</span><span class="p">,</span>
        <span class="s">&quot;suma rangos pos&quot;</span> <span class="p">:</span> <span class="n">T_Mas</span><span class="p">,</span> <span class="s">&quot;suma rangos neg&quot;</span> <span class="p">:</span> <span class="n">T_Men</span><span class="p">}</span>


</div>
<span class="k">def</span> <span class="nf">test_ranking</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">post_hoc</span><span class="p">,</span> <span class="n">nombres_algoritmos</span><span class="p">,</span> <span class="n">matriz_datos</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tipo</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Función general que sirve para ejecutar test de ranking + POST-HOC sin acoplamiento.&quot;&quot;&quot;</span>

    <span class="c">#Cálculo del resultado del test de ranking elegido.</span>
    <span class="n">resultado_ranking</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">,</span> <span class="n">matriz_datos</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">tipo</span><span class="p">)</span>

    <span class="c">#Lista de tests POST-HOC de método de control (no multitests).</span>
    <span class="n">post_hoc_metodo_control</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;bonferroni_dunn_test&quot;</span><span class="p">,</span> <span class="s">&quot;holm_test&quot;</span><span class="p">,</span> <span class="s">&quot;hochberg_test&quot;</span><span class="p">,</span> <span class="s">&quot;li_test&quot;</span><span class="p">,</span> <span class="s">&quot;finner_test&quot;</span><span class="p">]</span>

    <span class="c">#Si el test de ranking es estadísticamente significativo, se caculan los datos comunes del POST-HOC de comparación</span>
    <span class="c">#múltiple o del POST-HOC con método de control y se calcula el resultado del mismo.</span>
    <span class="k">if</span> <span class="n">resultado_ranking</span><span class="p">[</span><span class="s">&quot;resultado&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>

        <span class="n">resultado_post_hoc</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">post_hoc</span><span class="o">.</span><span class="n">__name__</span> <span class="ow">in</span> <span class="n">post_hoc_metodo_control</span><span class="p">:</span>
            <span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span> <span class="o">=</span> <span class="n">datos_comunes_tests</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">resultado_ranking</span><span class="p">[</span><span class="s">&quot;nombres&quot;</span><span class="p">],</span> <span class="n">resultado_ranking</span><span class="p">[</span><span class="s">&quot;ranking&quot;</span><span class="p">],</span> <span class="n">N</span><span class="p">)</span>
            <span class="n">resultado_post_hoc</span> <span class="o">=</span> <span class="n">post_hoc</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span> <span class="o">=</span> <span class="n">datos_comunes_multitests</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">resultado_ranking</span><span class="p">[</span><span class="s">&quot;nombres&quot;</span><span class="p">],</span> <span class="n">resultado_ranking</span><span class="p">[</span><span class="s">&quot;ranking&quot;</span><span class="p">],</span> <span class="n">N</span><span class="p">)</span>
            <span class="n">resultado_post_hoc</span> <span class="o">=</span> <span class="n">post_hoc</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;test_ranking&quot;</span> <span class="p">:</span> <span class="n">resultado_ranking</span><span class="p">,</span> <span class="s">&quot;test_comparacion&quot;</span> <span class="p">:</span> <span class="n">resultado_post_hoc</span><span class="p">}</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;test_ranking&quot;</span> <span class="p">:</span> <span class="n">resultado_ranking</span><span class="p">}</span>



<div class="viewcode-block" id="friedman_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.friedman_test">[docs]</a><span class="k">def</span> <span class="nf">friedman_test</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">,</span> <span class="n">matriz_datos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tipo</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test de Friedman.</span>

<span class="sd">    .. note:: Contrasta la hipótesis nula de que todos los algoritmos se comportan de forma similar, por lo que sus rankings deben</span>
<span class="sd">              de ser similares y por tanto se puedan considerar iguales todos los algoritmos. El estadístico se distribuye como</span>
<span class="sd">              una distribución chi-cuadrado con K-1 grados de libertad, siendo K el número de variables relacionadas (o número de algoritmos).</span>
<span class="sd">              Realiza comparaciones y asigna rankings dentro de cada conjunto de datos. Se asignan rankings medios en caso de empate.</span>

<span class="sd">    Args:</span>
<span class="sd">        nombres_algoritmos: lista de string [K_algoritmos]</span>
<span class="sd">            Lista que contiene los nombres de los algoritmos involucrados en el contraste.</span>
<span class="sd">        matriz_datos: lista de listas de float [N_conjuntos_datos * K_algoritmos]</span>
<span class="sd">            Lista que contiene una serie de listas que a su vez contienen los resultados en floats obtenidos por los distintos</span>
<span class="sd">            algoritmos.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) que se quiere utilizar para contrastar la hipótesis nula del</span>
<span class="sd">            test.</span>
<span class="sd">        tipo: int, optional (default = 0)</span>
<span class="sd">            Valor que indica si lo que se quiere es minimizar (0) o maximizar (1). Influye en la asignación de rankings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            resultado: boolean</span>
<span class="sd">                Resultado del test de contraste de hipótesis. True indica que se rechaza la hipótesis nula. False indica que no</span>
<span class="sd">                se rechaza.</span>
<span class="sd">            p_valor: float</span>
<span class="sd">                p-valor calculado para comparar (contrastar H0) con el nivel de significancia.</span>
<span class="sd">            estadistico: float</span>
<span class="sd">                Estadístico de Friedman, que se distribuye como una distribución chi-cuadrado con K-1 grados de libertad, siendo</span>
<span class="sd">                K el número de variables relacionadas (o número de algoritmos).</span>
<span class="sd">            nombres: lista de string [K_algoritmos]</span>
<span class="sd">                Lista que contiene los nombres de los algoritmos involucrados en el contraste en el orden del ranking.</span>
<span class="sd">            ranking: lista de float [K_algoritmos]</span>
<span class="sd">                Lista que contiene los rankings medios (de todos los conjuntos de datos) de los algoritmos involucrados en el</span>
<span class="sd">                contraste ordenados de peor a mejor.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Número de algoritmos.</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">)</span>

    <span class="c">#Número de conjuntos de datos (Número de veces que se aplican los algoritmos o número de</span>
    <span class="c">#problemas).</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">)</span>

    <span class="c">#Asignación de rankings a los resultados obtenidos por cada algoritmo en cada problema.</span>
    <span class="c">#Cada fila representa un conjunto de datos compuesto por los valores (rankings) asignados.</span>
    <span class="c">#Los valores se asignan de forma ascencente: 1 al mejor resultado, 2 al segundo, etc. En</span>
    <span class="c">#caso de empates, se asignan valores medios.</span>
    <span class="n">rankings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">conj_datos</span> <span class="ow">in</span> <span class="n">matriz_datos</span><span class="p">:</span>
        <span class="n">ranking_conj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">copia</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">conj_datos</span><span class="p">)</span>
        <span class="c">#Ordenamos según el problema se tratase de maximizar o minimizar.</span>
        <span class="n">copia</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="n">tipo</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dato</span> <span class="ow">in</span> <span class="n">conj_datos</span><span class="p">:</span>
            <span class="n">ranking_conj</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">copia</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dato</span><span class="p">)</span><span class="o">+</span><span class="n">copia</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dato</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">rankings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ranking_conj</span><span class="p">)</span>

    <span class="c">#Cálculo de los rankings medios de los algoritmos sobre los N problemas.</span>
    <span class="n">rankings_medios</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">rankings_medios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">fila</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">rankings</span><span class="p">]))</span>

    <span class="c">#Cálculo del estadístico de Friedman, que se distribuye como una distribución chi-cuadrado</span>
    <span class="c">#con K-1 grados de libertad, siendo K el número de variables relacionadas (o número de algoritmos).</span>
    <span class="n">chi2</span> <span class="o">=</span> <span class="p">((</span><span class="mi">12</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">))))</span><span class="o">*</span><span class="p">((</span><span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rankings_medios</span><span class="p">))</span><span class="o">-</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>

    <span class="c">#Cálculo del p_valor: Probabilidad de obtener un valor al menos tan extremo como el estadístico</span>
    <span class="c">#chi2.</span>
    <span class="n">p_valor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">chi2</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c">#Cálculo del ranking de los nombres de los algoritmos (de acuerdo a los rankings medios obtenidos).</span>
    <span class="n">ranking_nombres</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">({</span><span class="n">nombres_algoritmos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">rankings_medios</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">)}</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">ranking_nombres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c">#Ordenamiento de menor a mayor de los rankings medios obtenidos.</span>
    <span class="n">rankings_medios</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">p_valor</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">),</span> <span class="s">&quot;p_valor&quot;</span> <span class="p">:</span> <span class="n">p_valor</span><span class="p">,</span> <span class="s">&quot;estadistico&quot;</span> <span class="p">:</span> <span class="n">chi2</span><span class="p">,</span>
    <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">ranking_nombres</span><span class="p">,</span> <span class="s">&quot;ranking&quot;</span> <span class="p">:</span> <span class="n">rankings_medios</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="iman_davenport_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.iman_davenport_test">[docs]</a><span class="k">def</span> <span class="nf">iman_davenport_test</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">,</span> <span class="n">matriz_datos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tipo</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test de Iman-Davenport.</span>

<span class="sd">    .. note:: Contrasta la hipótesis nula de que todos los algoritmos se comportan de forma similar, por lo que sus rankings deben</span>
<span class="sd">              de ser similares y por tanto se puedan considerar iguales todos los algoritmos. Es una mejora del test de Friedman</span>
<span class="sd">              (para evitar el comportamiento conservativo de éste) por lo que presenta un estadístico más ajustado que se distribuye</span>
<span class="sd">              de acuerdo a una distribución f con (K-1) y (K-1)*(N-1) grados de libertad. Realiza comparaciones y asigna rankings</span>
<span class="sd">              dentro de cada conjunto de datos. Se asignan rankings medios en caso de empate.</span>

<span class="sd">    Args:</span>
<span class="sd">        nombres_algoritmos: lista de string [K_algoritmos]</span>
<span class="sd">            Lista que contiene los nombres de los algoritmos involucrados en el contraste.</span>
<span class="sd">        matriz_datos: lista de listas de float [N_conjuntos_datos * K_algoritmos]</span>
<span class="sd">            Lista que contiene una serie de listas que a su vez contienen los resultados en floats obtenidos por los distintos</span>
<span class="sd">            algoritmos.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) que se quiere utilizar para contrastar la hipótesis nula del</span>
<span class="sd">            test.</span>
<span class="sd">        tipo: int, optional (default = 0)</span>
<span class="sd">            Valor que indica si lo que se quiere es minimizar (0) o maximizar (1). Influye en la asignación de rankings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            resultado: boolean</span>
<span class="sd">                Resultado del test de contraste de hipótesis. True indica que se rechaza la hipótesis nula. False indica que no</span>
<span class="sd">                se rechaza.</span>
<span class="sd">            p_valor: float</span>
<span class="sd">                p-valor calculado para comparar (contrastar H0) con el nivel de significancia.</span>
<span class="sd">            estadistico: float</span>
<span class="sd">                Estadístico de Iman-Davenport, que se distribuye de acuerdo a una distribución f con (K-1) y (K-1)*(N-1) grados de</span>
<span class="sd">                libertad.</span>
<span class="sd">            nombres: lista de string [K_algoritmos]</span>
<span class="sd">                Lista que contiene los nombres de los algoritmos involucrados en el contraste en el orden del ranking.</span>
<span class="sd">            ranking: lista de float [K_algoritmos]</span>
<span class="sd">                Lista que contiene los rankings medios (de todos los conjuntos de datos) de los algoritmos involucrados en el</span>
<span class="sd">                contraste ordenados de peor a mejor.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Número de algoritmos.</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">)</span>

    <span class="c">#Número de conjuntos de datos (Número de veces que se aplican los algoritmos o número de</span>
    <span class="c">#problemas).</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">)</span>

    <span class="c"># Cálculo del estadistico de Friedman.</span>
    <span class="n">friedman</span> <span class="o">=</span> <span class="n">friedman_test</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">,</span> <span class="n">matriz_datos</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">tipo</span><span class="p">)</span>
    <span class="n">chi2</span> <span class="o">=</span> <span class="n">friedman</span><span class="p">[</span><span class="s">&quot;estadistico&quot;</span><span class="p">]</span>

    <span class="c"># Cálculo del estadistico de Iman-Davenport, que se distribuye de acuerdo a una distribución</span>
    <span class="c">#f con (K-1) y (K-1)(N-1) grados de libertad.</span>
    <span class="n">iman_davenport</span> <span class="o">=</span> <span class="p">((</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">chi2</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">((</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">chi2</span><span class="p">))</span>

    <span class="c">#Cálculo del p_valor: Probabilidad de obtener un valor al menos tan extremo como el estadístico</span>
    <span class="c">#iman_davenport.</span>
    <span class="n">p_valor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">st</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">iman_davenport</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">p_valor</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">),</span> <span class="s">&quot;p_valor&quot;</span> <span class="p">:</span> <span class="n">p_valor</span><span class="p">,</span> <span class="s">&quot;estadistico&quot;</span> <span class="p">:</span> <span class="n">iman_davenport</span><span class="p">,</span>
    <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">friedman</span><span class="p">[</span><span class="s">&quot;nombres&quot;</span><span class="p">],</span> <span class="s">&quot;ranking&quot;</span> <span class="p">:</span> <span class="n">friedman</span><span class="p">[</span><span class="s">&quot;ranking&quot;</span><span class="p">]}</span>


</div>
<div class="viewcode-block" id="friedman_rangos_alineados_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.friedman_rangos_alineados_test">[docs]</a><span class="k">def</span> <span class="nf">friedman_rangos_alineados_test</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">,</span> <span class="n">matriz_datos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tipo</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test de los Rangos Alineados de Friedman.</span>

<span class="sd">    .. note:: Contrasta la hipótesis nula de que todos los algoritmos se comportan de forma similar, por lo que sus rankings deben</span>
<span class="sd">              de ser similares y por tanto se puedan considerar iguales todos los algoritmos. El estadístico se distribuye como</span>
<span class="sd">              una distribución chi-cuadrado con K-1 grados de libertad, siendo K el número de variables relacionadas (o número de algoritmos).</span>
<span class="sd">              Realiza comparaciones y asigna rankings teniendo en cuenta a todos los conjuntos de datos. Se asignan rankings medios</span>
<span class="sd">              en caso de empate. Suele emplearse cuando el número de algoritmos en la comparación es pequeño.</span>

<span class="sd">    Args:</span>
<span class="sd">        nombres_algoritmos: lista de string [K_algoritmos]</span>
<span class="sd">            Lista que contiene los nombres de los algoritmos involucrados en el contraste.</span>
<span class="sd">        matriz_datos: lista de listas de float [N_conjuntos_datos * K_algoritmos]</span>
<span class="sd">            Lista que contiene una serie de listas que a su vez contienen los resultados en floats obtenidos por los distintos</span>
<span class="sd">            algoritmos.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) que se quiere utilizar para contrastar la hipótesis nula del</span>
<span class="sd">            test.</span>
<span class="sd">        tipo: int, optional (default = 0)</span>
<span class="sd">            Valor que indica si lo que se quiere es minimizar (0) o maximizar (1). Influye en la asignación de rankings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            resultado: boolean</span>
<span class="sd">                Resultado del test de contraste de hipótesis. True indica que se rechaza la hipótesis nula. False indica que no</span>
<span class="sd">                se rechaza.</span>
<span class="sd">            p_valor: float</span>
<span class="sd">                p-valor calculado para comparar (contrastar H0) con el nivel de significancia.</span>
<span class="sd">            estadistico: float</span>
<span class="sd">                Estadístico de los Rangos Alineados de Friedman, que se distribuye como una distribución chi-cuadrado con K-1 grados</span>
<span class="sd">                de libertad, siendo K el número de variables relacionadas (o número de algoritmos).</span>
<span class="sd">            nombres: lista de string [K_algoritmos]</span>
<span class="sd">                Lista que contiene los nombres de los algoritmos involucrados en el contraste en el orden del ranking.</span>
<span class="sd">            ranking: lista de float [K_algoritmos]</span>
<span class="sd">                Lista que contiene los rankings medios (de todos los conjuntos de datos) de los algoritmos involucrados en el</span>
<span class="sd">                contraste ordenados de peor a mejor.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Número de algoritmos.</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">)</span>

    <span class="c">#Número de conjuntos de datos (Número de veces que se aplican los algoritmos o número de</span>
    <span class="c">#problemas).</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">)</span>

    <span class="c">#Cálculo de las observaciones alienadas: Primero se halla el valor de localización, que es el</span>
    <span class="c">#rendimiento medio alcanzado por cada algoritmo en cada conjunto de datos. Luego, se calculan</span>
    <span class="c">#las diferencias entre el rendimiento obtenido por cada algoritmo con respecto al valor de localización.</span>
    <span class="c">#Se repite para todos los algoritmos y conjuntos de datos.</span>
    <span class="n">observaciones_alineadas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">conj_datos</span> <span class="ow">in</span> <span class="n">matriz_datos</span><span class="p">:</span>
        <span class="n">fila_observaciones</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">valor_localizacion</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">conj_datos</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dato</span> <span class="ow">in</span> <span class="n">conj_datos</span><span class="p">:</span>
            <span class="n">fila_observaciones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dato</span><span class="o">-</span><span class="n">valor_localizacion</span><span class="p">)</span>
        <span class="n">observaciones_alineadas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fila_observaciones</span><span class="p">)</span>

    <span class="c"># Creación de una lista a partir de la tabla observaciones_alineadas.</span>
    <span class="n">tabla_a_lista</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">observaciones_alineadas</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">dato</span> <span class="ow">in</span> <span class="n">fila</span><span class="p">:</span>
            <span class="n">tabla_a_lista</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dato</span><span class="p">)</span>

    <span class="c"># Ordenación de la lista.</span>
    <span class="n">tabla_a_lista</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="n">tipo</span><span class="p">)</span>

    <span class="c">#Asignación de rankings a los resultados obtenidos por cada algoritmo en cada problema.</span>
    <span class="c">#Cada fila representa un conjunto de datos compuesto por los rankings asignados. Los</span>
    <span class="c">#rankings se asignan de forma ascencente: 1 al mejor resultado, 2 al segundo, ... hasta</span>
    <span class="c">#K*N. En caso de empates, se asignan valores medios.</span>
    <span class="n">rankings</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">observaciones_alineadas</span><span class="p">:</span>
        <span class="n">ranking_conj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dato</span> <span class="ow">in</span> <span class="n">fila</span><span class="p">:</span>
            <span class="n">ranking_conj</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tabla_a_lista</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dato</span><span class="p">)</span><span class="o">+</span><span class="n">tabla_a_lista</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dato</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">rankings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ranking_conj</span><span class="p">)</span>

    <span class="c">#Cálculo de los rankings medios de los algoritmos sobre los N problemas y de la suma de los</span>
    <span class="c">#ranking obtenidos por cada algoritmo.</span>
    <span class="n">rankings_medios</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">totales_algoritmos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">rankings_medios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">fila</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">rankings</span><span class="p">]))</span>
        <span class="n">totales_algoritmos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">fila</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">rankings</span><span class="p">]))</span>

    <span class="c">#Cálculo de suma de los rankings obtenidos para cada conjunto de datos.</span>
    <span class="n">totales_conjuntos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rankings</span><span class="p">:</span>
        <span class="n">totales_conjuntos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="c">#Cálculo del estadístico de los Rangos Alineados de Friedman.</span>
    <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">total</span> <span class="ow">in</span> <span class="n">totales_algoritmos</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(((</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">K</span><span class="p">))</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">total</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">total</span> <span class="ow">in</span> <span class="n">totales_conjuntos</span><span class="p">))</span>

    <span class="c">#Cálculo del p_valor: Probabilidad de obtener un valor al menos tan extremo como el estadístico T.</span>
    <span class="n">p_valor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">st</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c">#Cálculo del ranking de los nombres de los algoritmos (de acuerdo a los rankings medios obtenidos).</span>
    <span class="n">ranking_nombres</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">({</span><span class="n">nombres_algoritmos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">rankings_medios</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">)}</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">ranking_nombres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c">#Ordenamiento de menor a mayor de los rankings medios obtenidos.</span>
    <span class="n">rankings_medios</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">p_valor</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">),</span> <span class="s">&quot;p_valor&quot;</span> <span class="p">:</span> <span class="n">p_valor</span><span class="p">,</span> <span class="s">&quot;estadistico&quot;</span> <span class="p">:</span> <span class="n">T</span><span class="p">,</span>
    <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">ranking_nombres</span><span class="p">,</span> <span class="s">&quot;ranking&quot;</span> <span class="p">:</span> <span class="n">rankings_medios</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="quade_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.quade_test">[docs]</a><span class="k">def</span> <span class="nf">quade_test</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">,</span> <span class="n">matriz_datos</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">tipo</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test de Quade.</span>

<span class="sd">    .. note:: Contrasta la hipótesis nula de que todos los algoritmos se comportan de forma similar, por lo que sus rankings deben</span>
<span class="sd">              de ser similares y por tanto se puedan considerar iguales todos los algoritmos. El estadístico se distribuye como una</span>
<span class="sd">              distribución F con (K-1) y (K-1)*(N-1) grados de libertad siendo K el número de variables relacionadas (o número de algoritmos)</span>
<span class="sd">              y N el número de conjuntos de datos. El test de Quade considera que algunos problemas son más difíciles o que los</span>
<span class="sd">              resultados que obtienen los algoritmos sobre ellos son más distantes (ponderación). Se asignan rankings medios en caso</span>
<span class="sd">              de empate.</span>

<span class="sd">    Args:</span>
<span class="sd">        nombres_algoritmos: lista de string [K_algoritmos]</span>
<span class="sd">            Lista que contiene los nombres de los algoritmos involucrados en el contraste.</span>
<span class="sd">        matriz_datos: lista de listas de float [N_conjuntos_datos * K_algoritmos]</span>
<span class="sd">            Lista que contiene una serie de listas que a su vez contienen los resultados en floats obtenidos por los distintos</span>
<span class="sd">            algoritmos.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) que se quiere utilizar para contrastar la hipótesis nula del</span>
<span class="sd">            test.</span>
<span class="sd">        tipo: int, optional (default = 0)</span>
<span class="sd">            Valor que indica si lo que se quiere es minimizar (0) o maximizar (1). Influye en la asignación de rankings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            resultado: boolean</span>
<span class="sd">                Resultado del test de contraste de hipótesis. True indica que se rechaza la hipótesis nula. False indica que no</span>
<span class="sd">                se rechaza.</span>
<span class="sd">            p_valor: float</span>
<span class="sd">                p-valor calculado para comparar (contrastar H0) con el nivel de significancia.</span>
<span class="sd">            estadistico: float</span>
<span class="sd">                Estadístico de Quade, que se distribuye como una distribución F con (K-1) y (K-1)*(N-1) grados de libertad siendo K</span>
<span class="sd">                el número de variables relacionadas (o número de algoritmos) y N el número de conjuntos de datos.</span>
<span class="sd">            nombres: lista de string [K_algoritmos]</span>
<span class="sd">                Lista que contiene los nombres de los algoritmos involucrados en el contraste en el orden del ranking.</span>
<span class="sd">            ranking: lista de float [K_algoritmos]</span>
<span class="sd">                Lista que contiene los rankings medios (de todos los conjuntos de datos) de los algoritmos involucrados en el</span>
<span class="sd">                contraste ordenados de peor a mejor.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Número de algoritmos.</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">nombres_algoritmos</span><span class="p">)</span>

    <span class="c">#Número de conjuntos de datos (Número de veces que se aplican los algoritmos o número de</span>
    <span class="c">#problemas).</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matriz_datos</span><span class="p">)</span>

    <span class="c">#Asignación de rankings a los resultados obtenidos por cada algoritmo en cada problema de forma</span>
    <span class="c">#similar al test de Friedman: cada fila representa un conjunto de datos compuesto por los</span>
    <span class="c">#valores (rankings) asignados. Los valores se asignan de forma ascencente: 1 al mejor resultado,</span>
    <span class="c">#2 al segundo, etc. En caso de empates, se asignan valores medios.</span>
    <span class="n">rankings_resultados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">conj_datos</span> <span class="ow">in</span> <span class="n">matriz_datos</span><span class="p">:</span>
        <span class="n">ranking_conj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">copia</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">conj_datos</span><span class="p">)</span>
        <span class="c">#Ordenamos según el problema se tratase de maximizar o minimizar.</span>
        <span class="n">copia</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">reverse</span><span class="o">=</span><span class="n">tipo</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dato</span> <span class="ow">in</span> <span class="n">conj_datos</span><span class="p">:</span>
            <span class="n">ranking_conj</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">copia</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dato</span><span class="p">)</span><span class="o">+</span><span class="n">copia</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">dato</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">rankings_resultados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ranking_conj</span><span class="p">)</span>

    <span class="c">#Los rankings se asignan a los problemas de acuerdo al tamaño del rango de la muestra en cada</span>
    <span class="c">#uno. El rango de la muestra en un problema es la diferencia entre la observación más alta y</span>
    <span class="c">#la más baja en dicho problema. Se asigna el ranking 1 al conjunto con el menor rango, el 2 al</span>
    <span class="c">#segundo con menor rango, etc. Se utilizan rankings medios en caso de empate.</span>
    <span class="n">rankings_problemas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">rangos</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">conj_datos</span> <span class="ow">in</span> <span class="n">matriz_datos</span><span class="p">:</span>
        <span class="n">rangos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">conj_datos</span><span class="p">)</span><span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="n">conj_datos</span><span class="p">))</span>
    <span class="n">copia</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">rangos</span><span class="p">)</span>
    <span class="n">copia</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">rango</span> <span class="ow">in</span> <span class="n">rangos</span><span class="p">:</span>
        <span class="n">rankings_problemas</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">copia</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">rango</span><span class="p">)</span><span class="o">+</span><span class="n">copia</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">rango</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>

    <span class="c">#S, W.</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">W</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ranking_medio</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">contador_problemas</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ranking_conj</span> <span class="ow">in</span> <span class="n">rankings_resultados</span><span class="p">:</span>
        <span class="n">fila_s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">fila_w</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
            <span class="n">fila_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rankings_problemas</span><span class="p">[</span><span class="n">contador_problemas</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">ranking_conj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ranking_medio</span><span class="p">))</span>
            <span class="n">fila_w</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rankings_problemas</span><span class="p">[</span><span class="n">contador_problemas</span><span class="p">]</span><span class="o">*</span><span class="n">ranking_conj</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">contador_problemas</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">S</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fila_s</span><span class="p">)</span>
        <span class="n">W</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fila_w</span><span class="p">)</span>

    <span class="c">#Sj, Wj.</span>
    <span class="n">Sj</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">Wj</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">Sj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fila</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">S</span><span class="p">))</span>
        <span class="n">Wj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fila</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">fila</span> <span class="ow">in</span> <span class="n">W</span><span class="p">))</span>

    <span class="c">#Rankings medios.</span>
    <span class="n">rankings_medios</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">rankings_medios</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Wj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="nb">float</span><span class="p">((</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

    <span class="c">#Términos A, B.</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">72</span><span class="p">)</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Sj</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

    <span class="c">#Cáculo del estadístico.</span>
    <span class="n">T</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">B</span><span class="p">)</span>

    <span class="c">#Cálculo del p_valor: Probabilidad de obtener un valor al menos tan extremo como el estadístico T.</span>
    <span class="n">p_valor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">st</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="c">#Cálculo del ranking de los nombres de los algoritmos (de acuerdo a los rankings medios obtenidos).</span>
    <span class="n">ranking_nombres</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">({</span><span class="n">nombres_algoritmos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">rankings_medios</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">)}</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">ranking_nombres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c">#Ordenamiento de menor a mayor de los rankings medios obtenidos.</span>
    <span class="n">rankings_medios</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">p_valor</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">),</span> <span class="s">&quot;p_valor&quot;</span> <span class="p">:</span> <span class="n">p_valor</span><span class="p">,</span> <span class="s">&quot;estadistico&quot;</span> <span class="p">:</span> <span class="n">T</span><span class="p">,</span>
    <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">ranking_nombres</span><span class="p">,</span> <span class="s">&quot;ranking&quot;</span> <span class="p">:</span> <span class="n">rankings_medios</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="datos_comunes_tests"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.datos_comunes_tests">[docs]</a><span class="k">def</span> <span class="nf">datos_comunes_tests</span><span class="p">(</span><span class="n">test_principal</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">ranking</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cálculo de los datos comunes a los tests de comparación POST-HOC.</span>

<span class="sd">    .. note:: Función utilizada por todos los tests de comparación POST-HOC para obtener los datos comunes. Los estadísticos Z</span>
<span class="sd">              siguen una distribución normal. Los valores de los estadísticos cambian en función de si el test principal es</span>
<span class="sd">              Friedman o Iman-Davenport, Rangos Alineados de Friedman o Quade.</span>

<span class="sd">    Args:</span>
<span class="sd">        test_principal: {&#39;friedman&#39;, &#39;iman-davenport&#39;, quade&#39;, &#39;rangos-alineados&#39;}</span>
<span class="sd">            Nombre del test principal o test de ranking ejecutado.</span>
<span class="sd">        nombres: lista de string [K_algoritmos]</span>
<span class="sd">            Lista que contiene los nombres de los algoritmos involucrados en el contraste en el orden del ranking obtenido por el</span>
<span class="sd">            test principal.</span>
<span class="sd">        ranking: lista de float [K_algoritmos]</span>
<span class="sd">            Lista que contiene los rankings medios (de todos los conjuntos de datos) de los algoritmos involucrados en el</span>
<span class="sd">            contraste ordenados de peor a mejor obtenidos por el test principal.</span>
<span class="sd">        N: int</span>
<span class="sd">            Número de conjuntos de datos o problemas sobre los que se aplican los algoritmos.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            K: int</span>
<span class="sd">                Número de algoritmos (incluyendo método de control).</span>
<span class="sd">            nombres: lista de string [K-1]</span>
<span class="sd">                Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">            valores_z: lista de float [K-1]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K-1]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            metodo_control: string</span>
<span class="sd">                Método de control del test, por convención es el test de menor ranking.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Número de algoritmos K (incluyendo método de control).</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>

    <span class="c">#Cálculo del estadístico Z (distribución normal). El valor cambia en función de si el</span>
    <span class="c">#test principal es Friedman o Iman-Davenport, Rangos Alineados de Friedman o Quade.</span>
    <span class="n">valores_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">test_principal</span> <span class="o">==</span> <span class="s">&quot;friedman&quot;</span> <span class="ow">or</span> <span class="n">test_principal</span> <span class="o">==</span> <span class="s">&quot;iman-davenport&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
            <span class="n">valores_z</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ranking</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">N</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="n">test_principal</span> <span class="o">==</span> <span class="s">&quot;rangos-alineados&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
            <span class="n">valores_z</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ranking</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
            <span class="n">valores_z</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ranking</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ranking</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">18</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))))</span>

    <span class="c">#Cálculo de los p_valores.</span>
    <span class="n">p_valores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">p_valores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">valores_z</span><span class="p">[</span><span class="n">i</span><span class="p">]))))</span>

    <span class="c">#Método de control (Primero del ranking).</span>
    <span class="n">metodo_control</span> <span class="o">=</span> <span class="n">nombres</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c">#Ordenamiento de los nombres, valores_z y p_valores segun el p_valor.</span>
    <span class="n">tabla</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nombres</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">valores_z</span><span class="p">,</span><span class="n">p_valores</span><span class="p">)</span>
    <span class="n">tabla</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">valor</span><span class="p">:</span> <span class="n">valor</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">tabla</span><span class="p">)</span>
    <span class="n">nombres</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">valores_z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">p_valores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span>


</div>
<div class="viewcode-block" id="bonferroni_dunn_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.bonferroni_dunn_test">[docs]</a><span class="k">def</span> <span class="nf">bonferroni_dunn_test</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test POST-HOC de Bonferroni-Dunn.</span>

<span class="sd">    .. note:: El contraste de las hipótesis se realiza comparando cada p_valor con :math:`\\frac{\\alpha}{(K-1)}.` Si el p_valor</span>
<span class="sd">              es menor que dicho alpha ajustado se rechaza la hipótesis nula.</span>

<span class="sd">    Args:</span>
<span class="sd">        K: int</span>
<span class="sd">            Número de algoritmos (incluyendo método de control).</span>
<span class="sd">        nombres: lista de string [K-1]</span>
<span class="sd">            Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">        valores_z: lista de float [K-1]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K-1]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        metodo_control: string</span>
<span class="sd">            Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K-1]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K-1]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            metodo de control: string</span>
<span class="sd">                Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">            nombres: lista de string [K-1]</span>
<span class="sd">                Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">            alpha: float</span>
<span class="sd">                Nivel de significancia ajustado.</span>
<span class="sd">            resultado: lista de boolean [K-1]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K-1]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Nuevo alpha.</span>
    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">resultado</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">alpha2</span><span class="p">))</span>

    <span class="c">#Cálculo de los p_valores_ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;metodo_control&quot;</span> <span class="p">:</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">nombres</span><span class="p">,</span>
    <span class="s">&quot;alpha&quot;</span> <span class="p">:</span> <span class="n">alpha2</span><span class="p">,</span> <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="holm_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.holm_test">[docs]</a><span class="k">def</span> <span class="nf">holm_test</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test POST-HOC de Holm.</span>

<span class="sd">    .. note:: Compara cada p_valor (empezando por el más significativo) con :math:`\\frac{\\alpha}{(K-i)},` donde i in range(1,K).</span>
<span class="sd">              Si se rechaza una hipótesis continúa contrastando. En el caso de que una hipótesis se rechace se rechazan todas las demás.</span>

<span class="sd">    Args:</span>
<span class="sd">        K: int</span>
<span class="sd">            Número de algoritmos (incluyendo método de control).</span>
<span class="sd">        nombres: lista de string [K-1]</span>
<span class="sd">            Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">        valores_z: lista de float [K-1]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K-1]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        metodo_control: string</span>
<span class="sd">            Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K-1]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K-1]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            metodo de control: string</span>
<span class="sd">                Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">            nombres: lista de string [K-1]</span>
<span class="sd">                Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">            alphas: lista de float [K-1]</span>
<span class="sd">                Niveles de significancia ajustados.</span>
<span class="sd">            resultado: lista de boolean [K-1]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K-1]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Valores alphas.</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="n">i</span><span class="p">))</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c">#Cálculo de los p_valores_ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([(</span><span class="n">K</span><span class="o">-</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">p_valores</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">nombres</span><span class="p">,</span>
    <span class="s">&quot;alphas&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span> <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="hochberg_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.hochberg_test">[docs]</a><span class="k">def</span> <span class="nf">hochberg_test</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test POST-HOC de Hochberg.</span>

<span class="sd">    .. note:: Compara en la dirección opuesta a Holm. En el momento que encuentra una hipótesis que pueda aceptar, acepta todas</span>
<span class="sd">              las demás.</span>

<span class="sd">    Args:</span>
<span class="sd">        K: int</span>
<span class="sd">            Número de algoritmos (incluyendo método de control).</span>
<span class="sd">        nombres: lista de string [K-1]</span>
<span class="sd">            Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">        valores_z: lista de float [K-1]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K-1]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        metodo_control: string</span>
<span class="sd">            Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K-1]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K-1]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            metodo de control: string</span>
<span class="sd">                Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">            nombres: lista de string [K-1]</span>
<span class="sd">                Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">            alphas: lista de float [K-1]</span>
<span class="sd">                Niveles de significancia ajustados.</span>
<span class="sd">            resultado: lista de boolean [K-1]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K-1]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Valores alphas.</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c">#Cálculo de los p_valores_ajustados (La pág. 137 pone max. Si no se pone min no da lo mismo</span>
    <span class="c">#que la pág. 142).</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">([(</span><span class="n">K</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">p_valores</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;metodo_control&quot;</span> <span class="p">:</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">nombres</span><span class="p">,</span>
    <span class="s">&quot;alphas&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span> <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="li_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.li_test">[docs]</a><span class="k">def</span> <span class="nf">li_test</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test POST-HOC de Li.</span>

<span class="sd">    .. note:: Rechaza todas las hipótesis si el p_valor menos significativo es menor que alpha. En otro caso, acepta dicha</span>
<span class="sd">              hipótesis y rechaza cualquier hipótesis restante cuyo p_valor sea menor que un valor calculado.</span>

<span class="sd">    Args:</span>
<span class="sd">        K: int</span>
<span class="sd">            Número de algoritmos (incluyendo método de control).</span>
<span class="sd">        nombres: lista de string [K-1]</span>
<span class="sd">            Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">        valores_z: lista de float [K-1]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K-1]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        metodo_control: string</span>
<span class="sd">            Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K-1]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K-1]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            metodo de control: string</span>
<span class="sd">                Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">            nombres: lista de string [K-1]</span>
<span class="sd">                Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">            resultado: lista de boolean [K-1]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K-1]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">K</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">alpha</span><span class="p">:</span>
        <span class="n">resultado</span><span class="p">[</span><span class="n">K</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span>  <span class="bp">False</span>
        <span class="n">valor</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">p_valores</span><span class="p">[</span><span class="n">K</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">))</span><span class="o">*</span><span class="n">alpha</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">2</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">valor</span><span class="p">:</span>
                <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="c">#Cálculo de los p_valores_ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">p_valores</span><span class="p">[</span><span class="n">K</span><span class="o">-</span><span class="mi">2</span><span class="p">]))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;metodo_control&quot;</span> <span class="p">:</span> <span class="n">metodo_control</span><span class="p">,</span>
    <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">nombres</span><span class="p">,</span> <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="finner_test"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.finner_test">[docs]</a><span class="k">def</span> <span class="nf">finner_test</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Test POST-HOC de Finner.</span>

<span class="sd">    .. note:: Sigue un proceso igual al test de Holm pero cada p-valor asociado con la hipótesis H_i se compara como:</span>
<span class="sd">              :math:`p_i &lt;= \\frac{\\alpha}{1-(1-\\alpha)^{(k-1)/i}}.`</span>

<span class="sd">    Args:</span>
<span class="sd">        K: int</span>
<span class="sd">            Número de algoritmos (incluyendo método de control).</span>
<span class="sd">        nombres: lista de string [K-1]</span>
<span class="sd">            Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">        valores_z: lista de float [K-1]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K-1]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        metodo_control: string</span>
<span class="sd">            Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K-1]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K-1]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            metodo de control: string</span>
<span class="sd">                Método de control del test, por convención es el test de menor ranking.</span>
<span class="sd">            nombres: lista de string [K-1]</span>
<span class="sd">                Nombres de los algoritmos (con los que el método de control se compara) ordenados según los p_valores.</span>
<span class="sd">            alphas: lista de float [K-1]</span>
<span class="sd">                Niveles de significancia ajustados.</span>
<span class="sd">            resultado: lista de boolean [K-1]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K-1]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. H. Finner, &quot;On a monotonicity problem in step-down multiple test procedures&quot;, Journal of the American Statistical Association 88 (1993) 920–923</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Valores alphas.</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="p">((</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c">#Cálculo de los p_valores ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p_valores</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="p">((</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;metodo_control&quot;</span> <span class="p">:</span> <span class="n">metodo_control</span><span class="p">,</span> <span class="s">&quot;nombres&quot;</span> <span class="p">:</span> <span class="n">nombres</span><span class="p">,</span>
    <span class="s">&quot;alphas&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span> <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="datos_comunes_multitests"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.datos_comunes_multitests">[docs]</a><span class="k">def</span> <span class="nf">datos_comunes_multitests</span><span class="p">(</span><span class="n">test_principal</span><span class="p">,</span> <span class="n">nombres</span><span class="p">,</span> <span class="n">ranking</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Cálculo de los datos comunes a los multitests de comparación POST-HOC.</span>

<span class="sd">    .. note:: Función utilizada por todos los multitests de comparación POST-HOC para obtener los datos comunes. Los estadísticos</span>
<span class="sd">              Z siguen una distribución normal. Los valores de los estadísticos cambian en función de si el test principal es</span>
<span class="sd">              Friedman o Iman-Davenport, Rangos Alineados de Friedman o Quade. Se realizan m comparaciones, donde :math:`m = \\frac{(K*(K-1))}{2}`.</span>

<span class="sd">    Args:</span>
<span class="sd">        test_principal: {&#39;friedman&#39;, &#39;iman-davenport&#39;, quade&#39;, &#39;rangos-alineados&#39;}</span>
<span class="sd">            Nombre del test principal o test de ranking ejecutado.</span>
<span class="sd">        nombres: lista de string [K_algoritmos]</span>
<span class="sd">            Lista que contiene los nombres de los algoritmos involucrados en el contraste en el orden del ranking obtenido por el</span>
<span class="sd">            test principal.</span>
<span class="sd">        ranking: lista de float [K_algoritmos]</span>
<span class="sd">            Lista que contiene los rankings medios (de todos los conjuntos de datos) de los algoritmos involucrados en el</span>
<span class="sd">            contraste ordenados de peor a mejor obtenidos por el test principal.</span>
<span class="sd">        N: int</span>
<span class="sd">            Número de conjuntos de datos o problemas sobre los que se aplican los algoritmos.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            m: int</span>
<span class="sd">                Número de comparaciones.</span>
<span class="sd">            comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">                Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">            valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Número de algoritmos K.</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>

    <span class="c">#Número posible de comparaciones.</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>

    <span class="c">#Nombres de las comparaciones.</span>
    <span class="n">comparaciones</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
            <span class="n">comparaciones</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nombres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot; vs &quot;</span> <span class="o">+</span> <span class="n">nombres</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>

    <span class="c">#Cálculo del estadístico Z (distribución normal). El valor cambia en función de si el</span>
    <span class="c">#test principal es Friedman o Iman-Davenport, Rangos Alineados de Friedman o Quade.</span>
    <span class="n">valores_z</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">test_principal</span> <span class="o">==</span> <span class="s">&quot;friedman&quot;</span> <span class="ow">or</span> <span class="n">test_principal</span> <span class="o">==</span> <span class="s">&quot;iman-davenport&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
                <span class="n">valores_z</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ranking</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">N</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="n">test_principal</span> <span class="o">==</span> <span class="s">&quot;rangos-alineados&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
                <span class="n">valores_z</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ranking</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">6</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">):</span>
                <span class="n">valores_z</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">ranking</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">ranking</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">18</span><span class="o">*</span><span class="n">N</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">))))</span>

    <span class="c">#Cálculo de los p_valores.</span>
    <span class="n">p_valores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">p_valores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">st</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">valores_z</span><span class="p">[</span><span class="n">i</span><span class="p">]))))</span>

    <span class="c">#Ordenamiento de las comparaciones, valores_z y p_valores segun el p_valor.</span>
    <span class="n">tabla</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">comparaciones</span><span class="p">,</span><span class="n">valores_z</span><span class="p">,</span><span class="n">p_valores</span><span class="p">)</span>
    <span class="n">tabla</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">valor</span><span class="p">:</span> <span class="n">valor</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">tabla</span><span class="p">)</span>
    <span class="n">comparaciones</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">valores_z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">p_valores</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span>


</div>
<div class="viewcode-block" id="nemenyi_multitest"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.nemenyi_multitest">[docs]</a><span class="k">def</span> <span class="nf">nemenyi_multitest</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;MultiTest POST-HOC de Nemenyi (Bonferroni-Dunn).</span>

<span class="sd">    .. note:: El contraste de las hipótesis se realiza comparando cada p_valor con :math:`\\frac{\\alpha}{m},` donde :math:`m = \\frac{(K*(K-1))}{2}`.</span>
<span class="sd">              Si el p_valor es menor que dicho alpha ajustado se rechaza la hipótesis nula.</span>

<span class="sd">    Args:</span>
<span class="sd">        m: int</span>
<span class="sd">            Número de comparaciones.</span>
<span class="sd">        comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">            Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">        valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">                Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">            alpha: float</span>
<span class="sd">                Nivel de significancia ajustado.</span>
<span class="sd">            resultado: lista de boolean [K*(K-1)/2]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Nuevo alpha.</span>
    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">resultado</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">alpha2</span><span class="p">))</span>

    <span class="c">#Cálculo de los p_valores_ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">*</span><span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;comparaciones&quot;</span> <span class="p">:</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="s">&quot;alpha&quot;</span> <span class="p">:</span> <span class="n">alpha2</span><span class="p">,</span>
    <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="holm_multitest"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.holm_multitest">[docs]</a><span class="k">def</span> <span class="nf">holm_multitest</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;MultiTest POST-HOC de Holm.</span>

<span class="sd">    .. note:: Compara cada p_valor (empezando por el más significativo) con :math:`\\frac{\\alpha}{(m+1-i)},` donde i in range(1,m+1) y</span>
<span class="sd">              :math:`m = \\frac{(K*(K-1))}{2}.` Si se rechaza una hipótesis continúa contrastando. En el caso de que una hipótesis se</span>
<span class="sd">              rechace se rechazan todas las demás.</span>

<span class="sd">    Args:</span>
<span class="sd">        m: int</span>
<span class="sd">            Número de comparaciones.</span>
<span class="sd">        comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">            Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">        valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">                Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">            alphas: array de float [K*(K-1)/2]</span>
<span class="sd">                Niveles de significancia ajustados</span>
<span class="sd">            resultado: lista de boolean [K*(K-1)/2]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Valores alphas.</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">))</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c">#Cálculo de los p_valores_ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([(</span><span class="n">m</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">p_valores</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;comparaciones&quot;</span> <span class="p">:</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="s">&quot;alphas&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span>
    <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="hochberg_multitest"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.hochberg_multitest">[docs]</a><span class="k">def</span> <span class="nf">hochberg_multitest</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;MultiTest POST-HOC de Hochberg.</span>

<span class="sd">    .. note:: Compara en la dirección opuesta a Holm. En el momento que encuentra una hipótesis que pueda aceptar, acepta todas</span>
<span class="sd">              las demás. m es el número de comparaciones o contrastes, :math:`m = \\frac{(K*(K-1))}{2}.`</span>

<span class="sd">    Args:</span>
<span class="sd">        m: int</span>
<span class="sd">            Número de comparaciones.</span>
<span class="sd">        comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">            Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">        valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">                Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">            alphas: array de float [K*(K-1)/2]</span>
<span class="sd">                Niveles de significancia ajustados</span>
<span class="sd">            resultado: lista de boolean [K*(K-1)/2]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. Salvador García, Francisco Herrera. *Statistical Analysis of Experiments in Data Mining and Computational Intelligence</span>
<span class="sd">           Computational Intelligence.*</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Valores alphas.</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c">#Cálculo de los p_valores_ajustados (La pág. 137 pone max. Si no se pone min no da lo mismo</span>
    <span class="c">#que la pág. 142).</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">([(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">p_valores</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;comparaciones&quot;</span> <span class="p">:</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="s">&quot;alphas&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span>
    <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="finner_multitest"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.finner_multitest">[docs]</a><span class="k">def</span> <span class="nf">finner_multitest</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;MultiTest POST-HOC de Finner.</span>

<span class="sd">    .. note:: Sigue un proceso igual al test de Holm pero cada p-valor asociado con la hipótesis H_i se compara como:</span>
<span class="sd">              :math:`p_i &lt;= \\frac{\\alpha}{1-(1-\\alpha)^{m/i}}.`</span>

<span class="sd">    Args:</span>
<span class="sd">        m: int</span>
<span class="sd">            Número de comparaciones.</span>
<span class="sd">        comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">            Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">        valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">                Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">            alphas: array de float [K*(K-1)/2]</span>
<span class="sd">                Niveles de significancia ajustados</span>
<span class="sd">            resultado: lista de boolean [K*(K-1)/2]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. H. Finner, &quot;On a monotonicity problem in step-down multiple test procedures&quot;, Journal of the American Statistical Association 88 (1993) 920–923</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Valores alphas.</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c">#Cálculo de los p_valores_ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p_valores</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">**</span><span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores_z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;comparaciones&quot;</span> <span class="p">:</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="s">&quot;alphas&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span>
    <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span>


</div>
<div class="viewcode-block" id="S"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.S">[docs]</a><span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Función auxiliar del test de Shaffer.</span>

<span class="sd">    .. note:: Calcula la secuencia de número máximo de hipótesis que pueden ser ciertas en una comparación secuencial entre &#39;K&#39;</span>
<span class="sd">              distribuciones.</span>

<span class="sd">    Args:</span>
<span class="sd">        k: int</span>
<span class="sd">            Número de distribuciones a comparar entre sí.</span>

<span class="sd">    Returns:</span>
<span class="sd">        lista de int</span>
<span class="sd">            Secuencia del número hipótesis que pueden ser ciertas.</span>

<span class="sd">    References:</span>
<span class="sd">        1. J.P. Shaffer. Modified sequentially rejective multiple test procedures. Journal of the American Statistical Association, 81(395):826–831, 1986.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">K</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">K</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="mi">0</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="n">j</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">union</span><span class="p">({</span><span class="n">sp</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span><span class="p">})</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="shaffer_multitest"><a class="viewcode-back" href="../tests_no_parametricos.html#tests_no_parametricos.shaffer_multitest">[docs]</a><span class="k">def</span> <span class="nf">shaffer_multitest</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="n">valores_z</span><span class="p">,</span> <span class="n">p_valores</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;MultiTest POST-HOC de Shaffer.</span>

<span class="sd">    .. note:: Sigue un proceso igual al test de holm multi-test pero cada p-valor asociado con la hipótesis H_i se compara como</span>
<span class="sd">              :math:`p_i &lt;= \\frac{\\alpha}{t_i},` donde t_i es el número máximo de hipótesis posibles suponiendo que las (j-1)</span>
<span class="sd">              anteriores han sido rechazadas.</span>

<span class="sd">    Args:</span>
<span class="sd">        m: int</span>
<span class="sd">            Número de comparaciones.</span>
<span class="sd">        comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">            Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">        valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">            Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">        p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">            p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">        alpha: float, optional (default = 0.05)</span>
<span class="sd">            Nivel de significancia (probabilidad de error tipo 1) del test de ranking principal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: diccionario que contiene los siguientes elementos::</span>

<span class="sd">            valores_z: lista de float [K*(K-1)/2]</span>
<span class="sd">                Estadísticos calculados durante el test. Siguen una normal (0, 1) y están ordenados según los p_valores.</span>
<span class="sd">            p_valores: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores calculados para comparar con los niveles de significancia ajustados.</span>
<span class="sd">            comparaciones: lista de string [K*(K-1)/2]</span>
<span class="sd">                Nombres de las hipótesis contrastadas. Por ejemplo &quot;algoritmoA vs algoritmoB&quot;.</span>
<span class="sd">            alphas: array de float [K*(K-1)/2]</span>
<span class="sd">                Niveles de significancia ajustados</span>
<span class="sd">            resultado: lista de boolean [K*(K-1)/2]</span>
<span class="sd">                Resultado de los tests de contraste de hipótesis. True es que se rechaza la hipótesis nula y False que no se</span>
<span class="sd">                rechaza.</span>
<span class="sd">            p_valores_ajustados: lista de float [K*(K-1)/2]</span>
<span class="sd">                p-valores ajustados, los cuales pueden ser comparados con el nivel de significancia proporcionado sin ajustar.</span>

<span class="sd">    References:</span>
<span class="sd">        1. J.P. Shaffer. Modified sequentially rejective multiple test procedures. Journal of the American Statistical Association, 81(395):826–831, 1986.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c">#Número máximo de hipótesis posibles.</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">S</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c">#Valores alphas.</span>
    <span class="n">alphas</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">t</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nb">max</span><span class="p">([</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">A</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">m</span><span class="o">-</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">alphas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c">#Cálculo de los resultados.</span>
    <span class="n">resultado</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span><span class="o">*</span><span class="n">m</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_valores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">alphas</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">resultado</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="c">#Cálculo de los p_valores ajustados.</span>
    <span class="n">p_valores_ajustados</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">p_valores</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="n">p_valores_ajustados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">{</span><span class="s">&quot;valores z&quot;</span> <span class="p">:</span> <span class="n">valores_z</span><span class="p">,</span> <span class="s">&quot;p_valores&quot;</span> <span class="p">:</span> <span class="n">p_valores</span><span class="p">,</span> <span class="s">&quot;comparaciones&quot;</span> <span class="p">:</span> <span class="n">comparaciones</span><span class="p">,</span> <span class="s">&quot;alphas&quot;</span> <span class="p">:</span> <span class="n">alphas</span><span class="p">,</span>
            <span class="s">&quot;resultado&quot;</span> <span class="p">:</span> <span class="n">resultado</span><span class="p">,</span> <span class="s">&quot;p_valores_ajustados&quot;</span> <span class="p">:</span> <span class="n">p_valores_ajustados</span><span class="p">}</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">Plataforma Web STAC v0.5 documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Adrián Canosa Mouzo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>